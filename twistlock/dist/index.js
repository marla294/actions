(()=>{"use strict";var e={};(()=>{e.d=(i,t)=>{for(var n in t){if(e.o(t,n)&&!e.o(i,n)){Object.defineProperty(i,n,{enumerable:true,get:t[n]})}}}})();(()=>{e.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i)})();(()=>{e.r=e=>{if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})}})();if(typeof e!=="undefined")e.ab=__dirname+"/";var i={};e.r(i);e.d(i,{writeSummary:()=>writeSummary});function markdownTable(e,i){const t=i||{};const n=(t.align||[]).concat();const l=t.stringLength||defaultStringLength;const r=[];let s=-1;const a=[];const o=[];const f=[];let u=0;let c;let m;let d;let g;let p;let h;let y;let b;let w;while(++s<e.length){c=-1;m=[];d=[];if(e[s].length>u){u=e[s].length}while(++c<e[s].length){p=serialize(e[s][c]);if(t.alignDelimiters!==false){g=l(p);d[c]=g;if(f[c]===undefined||g>f[c]){f[c]=g}}m.push(p)}a[s]=m;o[s]=d}c=-1;if(typeof n==="object"&&"length"in n){while(++c<u){r[c]=toAlignment(n[c])}}else{w=toAlignment(n);while(++c<u){r[c]=w}}c=-1;m=[];d=[];while(++c<u){w=r[c];y="";b="";if(w===99){y=":";b=":"}else if(w===108){y=":"}else if(w===114){b=":"}g=t.alignDelimiters===false?1:Math.max(1,f[c]-y.length-b.length);p=y+"-".repeat(g)+b;if(t.alignDelimiters!==false){g=y.length+g+b.length;if(g>f[c]){f[c]=g}d[c]=g}m[c]=p}a.splice(1,0,m);o.splice(1,0,d);s=-1;const v=[];while(++s<a.length){m=a[s];d=o[s];c=-1;h=[];while(++c<u){p=m[c]||"";y="";b="";if(t.alignDelimiters!==false){g=f[c]-(d[c]||0);w=r[c];if(w===114){y=" ".repeat(g)}else if(w===99){if(g%2){y=" ".repeat(g/2+.5);b=" ".repeat(g/2-.5)}else{y=" ".repeat(g/2);b=y}}else{b=" ".repeat(g)}}if(t.delimiterStart!==false&&!c){h.push("|")}if(t.padding!==false&&!(t.alignDelimiters===false&&p==="")&&(t.delimiterStart!==false||c)){h.push(" ")}if(t.alignDelimiters!==false){h.push(y)}h.push(p);if(t.alignDelimiters!==false){h.push(b)}if(t.padding!==false){h.push(" ")}if(t.delimiterEnd!==false||c!==u-1){h.push("|")}}v.push(t.delimiterEnd===false?h.join("").replace(/ +$/,""):h.join(""))}return v.join("\n")}function serialize(e){return e===null||e===undefined?"":String(e)}function defaultStringLength(e){return e.length}function toAlignment(e){const i=typeof e==="string"?e.charCodeAt(0):0;return i===67||i===99?99:i===76||i===108?108:i===82||i===114?114:0}const t=["critical","high","medium","low"];function Heading(e){return`${e.total===0?"üëé":"üëç"} - ${e.critical} critical, ${e.high} high, ${e.medium} medium, ${e.low} low`}function Vulnerabilities(e){const i=e.map((({severity:e,...i})=>({...i,severity:e,severityLevel:t.indexOf(e)}))).sort(((e,i)=>e.severityLevel-i.severityLevel));return markdownTable([["Severity","Package","Versions","Description","Risk Factor"],...i.map((e=>[e.severity,e.packageName,e.impactedVersions.join(", "),e.description,e.riskFactor.join(", ")]))])}async function writeSummary({github:e,context:i,results:t}){const{vulnerabilities:n,vulnerabilityDistribution:l}=t;const r=`\n    <details><summary>Vulnerabilities: ${Heading(l)}</summary>\n\n      ${Vulnerabilities(n)}\n\n    </details>\n  `;e.issues.createComment({issue_number:i.issue.number,owner:i.repo.owner,repo:i.repo.repo,body:r});if(!t.passed){throw new Error(`‚òπÔ∏è Twistlock failed!`)}}module.exports=i})();